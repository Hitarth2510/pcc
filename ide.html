<!-- ... rest of your HTML head remains unchanged ... -->
<body onload="initializeApp()">
  <header class="retro-header">
    <h1>Paradox '25</h1>
    <h2>Round 1</h2>
  </header>
  <div class="container">
    <div class="left-panel">
      <div class="problem-statement">
        <h2 id="problem-title">Loading...</h2>
        <p id="problem-description">Loading problem description...</p>
      </div>
      <div class="problem-input">
        <h3>Input</h3>
        <p id="problem-input">Loading input details...</p>
      </div>
      <div class="problem-output">
        <h3>Expected Output</h3>
        <p id="problem-output">Loading expected output...</p>
      </div>
    </div>
    <div class="editor-container">
      <h2>Code Editor</h2>
      <div id="code-editor"></div>
      <div class="buttons">
        <button onclick="runCode()">Run</button>
        <button onclick="clearOutput()">Clear Output</button>
        <button onclick="zoomIn()">Zoom In (+)</button>
        <button onclick="zoomOut()">Zoom Out (-)</button>
      </div>
    </div>
  </div>
  <div class="output-container">
    <h2>Console Output</h2>
    <pre id="output">No output yet...</pre>
    <div class="buttons">
      <button onclick="runDbTest()" style="background-color: #ff5555; margin-top: 10px;">Test Database Connection</button>
      <button onclick="createSampleData()" style="background-color: #33aaff; margin-top: 10px;">Create Sample Data</button>
    </div>
  </div>
  <script>
    // Initialize the application
    async function initializeApp() {
      console.log("Initializing app...");
      initializeEditor();
      // Delay fetching to ensure Supabase client is ready
      setTimeout(fetchProblemData, 500);
    }
    
    // Fetch problem data from Supabase using the correct table name: 'pcc_problems'
    async function fetchProblemData() {
      try {
        console.log("Fetching problem data...");
        if (!window.supabaseClient) {
          console.error("Supabase client not available");
          displayError("Connection Error", "Database client not initialized. Please refresh the page.");
          return;
        }
        const urlParams = new URLSearchParams(window.location.search);
        const problemId = urlParams.get('id') || 1;
        console.log(`Fetching problem with ID: ${problemId}`);
        
        // Use 'pcc_problems' table
        const { data, error } = await window.supabaseClient
          .from('pcc_problems')
          .select('*')
          .eq('id', problemId)
          .single();
        
        console.log("Supabase response:", { data, error });
        
        if (error) {
          console.error('Error fetching problem:', error);
          handleDatabaseError(error, problemId);
          return;
        }
        if (!data) {
          console.error('No data returned for problem ID:', problemId);
          displayError('Problem Not Found', `Could not find problem with ID ${problemId}.`);
          return;
        }
        // Populate the UI with the retrieved problem data
        populateProblemData(data);
      } catch (err) {
        console.error('Error in fetchProblemData:', err);
        displayError('Database Connection Error', 'Could not connect to the database.');
      }
    }
    
    // Display error message to user
    function displayError(title, message) {
      document.getElementById('problem-title').innerText = title;
      document.getElementById('problem-description').innerText = message;
      document.getElementById('problem-input').innerText = 'Error loading input';
      document.getElementById('problem-output').innerText = 'Error loading output';
      document.getElementById('output').innerText = `${title}: ${message}\nCheck console for details.`;
    }
    
    // Populate the UI with problem data
    function populateProblemData(data) {
      console.log('Populating UI with data:', data);
      const title = data.title || 'Untitled Problem';
      const description = data.description || 'No description available.';
      const inputFormat = data.input_format || 'No input format specified.';
      const expectedOutput = data.expected_output || 'No expected output specified.';
      const initialCode = data.initial_code || '# Write your solution here\n';
      
      document.getElementById('problem-title').innerText = title;
      document.getElementById('problem-description').innerText = description;
      document.getElementById('problem-input').innerText = inputFormat;
      document.getElementById('problem-output').innerText = expectedOutput;
      
      if (window.editor) {
        window.editor.setValue(initialCode);
      } else {
        console.warn('Editor not ready yet.');
      }
    }
    
    // Create sample data in 'pcc_problems' table
    async function createSampleData() {
      const outputElement = document.getElementById('output');
      outputElement.innerText = "Attempting to create sample problem data in 'pcc_problems'...\n";
      
      const sampleProblems = [
        {
          title: "Sum of Two Numbers",
          description: "Return the sum of two numbers.",
          input_format: "Two integers, a and b",
          expected_output: "Integer sum of a and b",
          initial_code: "# Write a function to add two numbers\ndef add_numbers(a, b):\n    pass\n\nprint(add_numbers(5, 3))"
        },
        {
          title: "Find Maximum",
          description: "Find the maximum value in an array.",
          input_format: "A list of integers",
          expected_output: "The maximum integer in the list",
          initial_code: "# Write a function to find the maximum\n\ndef find_maximum(numbers):\n    pass\n\nprint(find_maximum([4, 9, 2, 7, 5]))"
        },
        {
          title: "Palindrome Check",
          description: "Check if a string is a palindrome.",
          input_format: "A string",
          expected_output: "True if palindrome, otherwise False",
          initial_code: "# Write a function to check for palindrome\ndef is_palindrome(text):\n    pass\n\nprint(is_palindrome('racecar'))"
        }
      ];
      
      try {
        const { data, error } = await window.supabaseClient
          .from('pcc_problems')
          .insert(sampleProblems)
          .select();
          
        if (error) {
          outputElement.innerText += `Error creating sample data: ${error.message}\n`;
          return;
        }
        
        outputElement.innerText += `Successfully created ${data.length} sample problems in 'pcc_problems'.\n`;
      } catch (err) {
        outputElement.innerText += `Error: ${err.message}\n`;
      }
    }
    
    // (Remaining functions such as runCode, clearOutput, initializeEditor, zoomIn, zoomOut, etc. remain unchanged)
  </script>
</body>
</html>
